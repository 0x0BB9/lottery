import{_ as t}from"./chunk-DFocJlKq.js";import{u as a,i as l,a as e}from"./chunk-DcRzQRvl.js";import{s as o}from"./chunk-CzQyhFTa.js";import{u as n}from"./chunk-CpGxy-6g.js";import{r as s,u as i,w as r}from"./chunk-BAe5AcxJ.js";import{z as d,r as p,a as c,G as m,I as b,L as u,u as g,C as h,F as f,H as k}from"./chunk-D1bmVKlW.js";import"./chunk-Xjp0aulL.js";import"./chunk-DSek3MSI.js";import"./chunk-DvCEEdEu.js";import"./chunk-D_NMWU_S.js";import"./chunk-BlSyArh7.js";import"./chunk-D8C0JLsp.js";import"./chunk-bMn3hkY1.js";import"./chunk-C6Zwkpkb.js";import"./chunk-BA-TsAJo.js";import"./chunk-BLnK4V6m.js";import"./chunk-DSeHMosA.js";import"./chunk-B1xQziYE.js";import"./chunk-Ygk_sErt.js";import"./chunk-Cjrd7Wf_.js";import"./chunk-BT_ACNP_.js";const y={class:"modal-box"},j={class:"text-lg font-bold"},x={class:"py-4"},v={class:"modal-action"},_={method:"dialog",class:"flex gap-3"},A={class:"modal-box"},w={class:"text-lg font-bold"},N={class:"py-4"},T={class:"modal-action"},C={method:"dialog",class:"flex gap-3"},z={class:"min-w-1000px"},P={class:"flex gap-3"},D=["data-tip"],W=["download","href"],S={class:""},J={for:"explore"},L=["data-tip"],O={class:"btn btn-primary btn-sm"},M=d({__name:"PersonAll",setup(d){const{t:M}=n(),R=a().personConfig,F=a().prizeConfig,{getAllPersonList:I,getAlreadyPersonList:V}=o(R),$=p(),B=p();async function E(t){const a=await(l=t.target.files[0],new Promise((t=>{const a=new FileReader;a.readAsBinaryString(l),a.onload=a=>{t(a.target.result)}})));var l;const o=s(a,{type:"binary",cellDates:!0}),n=o.Sheets[o.SheetNames[0]],r=i.sheet_to_json(n),d=e(r);R.resetPerson(),R.addNotPersonList(d)}function G(){let t=JSON.parse(JSON.stringify(I.value));for(let e=0;e<t.length;e++)delete t[e].x,delete t[e].y,delete t[e].id,delete t[e].createTime,delete t[e].updateTime,delete t[e].prizeId,t[e].isWin?t[e].isWin=l.global.t("data.yes"):t[e].isWin=l.global.t("data.no"),t[e].prizeTime=t[e].prizeTime.join(","),t[e].prizeName=t[e].prizeName.join(",");let a=JSON.stringify(t);if(a=a.replaceAll(/uid/g,l.global.t("data.number")).replaceAll(/isWin/g,l.global.t("data.isWin")).replaceAll(/department/g,l.global.t("data.department")).replaceAll(/name/g,l.global.t("data.name")).replaceAll(/identity/g,l.global.t("data.identity")).replaceAll(/prizeName/g,l.global.t("data.prizeName")).replaceAll(/prizeTime/g,l.global.t("data.prizeTime")),t=JSON.parse(a),t.length>0){const a=i.json_to_sheet(t),l=i.book_new();i.book_append_sheet(l,a,"Sheet1"),r(l,"data.xlsx")}}function H(){R.resetAlreadyPerson(),F.resetDefault()}function q(){R.deleteAllPerson()}const K=[{label:l.global.t("data.number"),props:"uid"},{label:l.global.t("data.name"),props:"name"},{label:l.global.t("data.department"),props:"department"},{label:l.global.t("data.avatar"),props:"avatar",formatValue:t=>t.avatar?`<img src="${t.avatar}" alt="avatar" style="width: 50px; height: 50px;"/>`:"-"},{label:l.global.t("data.identity"),props:"identity"},{label:l.global.t("data.isWin"),props:"isWin",formatValue:t=>t.isWin?l.global.t("data.yes"):l.global.t("data.no")},{label:l.global.t("data.operation"),actions:[{label:l.global.t("data.delete"),type:"btn-error",onClick:t=>{!function(t){R.deletePerson(t)}(t)}}]}];return c((()=>{})),(a,l)=>(k(),m(f,null,[b("dialog",{id:"my_modal_1",ref_key:"resetDataDialog",ref:$,class:"border-none modal"},[b("div",y,[b("h3",j,u(g(M)("dialog.titleTip")),1),b("p",x,u(g(M)("dialog.dialogResetWinner")),1),b("div",v,[b("form",_,[b("button",{class:"btn",onClick:l[0]||(l[0]=t=>$.value.close())},u(g(M)("button.cancel")),1),b("button",{class:"btn",onClick:H},u(g(M)("button.confirm")),1)])])])],512),b("dialog",{id:"my_modal_1",ref_key:"delAllDataDialog",ref:B,class:"border-none modal"},[b("div",A,[b("h3",w,u(g(M)("dialog.titleTip")),1),b("p",N,u(g(M)("dialog.dialogDelAllPerson")),1),b("div",T,[b("form",C,[b("button",{class:"btn",onClick:l[1]||(l[1]=t=>B.value.close())},u(g(M)("button.cancel")),1),b("button",{class:"btn",onClick:q},u(g(M)("button.confirm")),1)])])])],512),b("div",z,[b("h2",null,u(g(M)("viewTitle.personManagement")),1),b("div",P,[b("button",{class:"btn btn-error btn-sm",onClick:l[2]||(l[2]=t=>B.value.showModal())},u(g(M)("button.allDelete")),1),b("div",{class:"tooltip tooltip-bottom","data-tip":g(M)("tooltip.downloadTemplateTip")},[b("a",{class:"no-underline btn btn-secondary btn-sm",download:g(M)("data.xlsxName"),target:"_blank",href:`/lottery/${g(M)("data.xlsxName")}`},u(g(M)("button.downloadTemplate")),9,W)],8,D),b("div",S,[b("label",J,[b("div",{class:"tooltip tooltip-bottom","data-tip":g(M)("tooltip.uploadExcelTip")},[b("input",{id:"explore",type:"file",class:"",style:{display:"none"},accept:".xlsx,.xls",onChange:E},null,32),b("span",O,u(g(M)("button.importData")),1)],8,L)])]),b("button",{class:"btn btn-error btn-sm",onClick:l[3]||(l[3]=t=>$.value.showModal())},u(g(M)("button.resetData")),1),b("button",{class:"btn btn-accent btn-sm",onClick:G},u(g(M)("button.exportResult")),1),b("div",null,[b("span",null,u(g(M)("table.luckyPeopleNumber"))+":",1),b("span",null,u(g(V).length),1),l[4]||(l[4]=b("span",null," / ",-1)),b("span",null,u(g(I).length),1)])]),h(t,{"table-columns":K,data:g(I)},null,8,["data"])])],64))}});export{M as default};
