import{u as e,g as a}from"./chunk-BkNLKfx9.js";import{a as s}from"./chunk-Czrwg_dh.js";import{l as t}from"./chunk-BIn6qnQq.js";import{s as n}from"./chunk-DrcNqKZP.js";import{u as r}from"./chunk-CmNriTaI.js";import{z as l,r as o,a as i,w as u,I as c,R as m,L as p,$ as h,u as d,F as v,Y as k,C as g,J as f}from"./chunk-D7BOcSyB.js";import"./chunk-Xjp0aulL.js";import"./chunk-DSek3MSI.js";import"./chunk-DvCEEdEu.js";import"./chunk-BWwx0SQ1.js";import"./chunk-CYfUI5Ys.js";import"./chunk-DwMdLFrw.js";import"./chunk-C6Zwkpkb.js";import"./chunk-BA-TsAJo.js";import"./chunk-BLnK4V6m.js";import"./chunk-DSeHMosA.js";import"./chunk-DC1XHIpb.js";import"./chunk-DE2u7Mu7.js";import"./chunk-Cjrd7Wf_.js";import"./chunk-BT_ACNP_.js";const j={class:"toast toast-top toast-end"},b={key:0,class:"alert alert-error"},y={key:1,class:"alert alert-success"},w={key:2,class:"alert alert-error"},I={class:""},x={for:"explore"},C=["accept"],S={class:"btn btn-primary btn-sm"},$={class:"p-0"},q={class:"flex items-center gap-8"},F={class:"avatar h-14"},L={class:"w-12 h-12 mask mask-squircle hover:w-14 hover:h-14"},N={class:"w-64"},T={class:"overflow-hidden font-bold whitespace-nowrap text-ellipsis"},_=["onClick"],z=l({__name:"ImageConfig",setup(l){const{t:z}=r(),D=e().globalConfig,{getImageList:J}=n(D),R=o("image/*"),U=o(0),Y=t.createInstance({name:"imgStore"});async function A(e){if(!/image*/.test(e.target.files[0].type))return void(U.value=3);const{dataUrl:a,fileName:t}=await s(e.target.files[0]);Y.setItem(`${(new Date).getTime().toString()}+${t}`,a).then((()=>{U.value=1,async function(){(await Y.keys()).length>0&&Y.iterate(((e,a)=>{D.addImage({id:a,name:a,url:"Storage"})}))}()})).catch((()=>{U.value=2}))}return i((()=>{})),u((()=>U.value),(e=>{0!==e&&setTimeout((()=>{U.value=0}),2e3)})),(e,s)=>(f(),c(v,null,[m("div",j,[2===U.value?(f(),c("div",b,[m("span",null,h(d(z)("error.uploadFail")),1)])):p("",!0),1===U.value?(f(),c("div",y,[m("span",null,h(d(z)("error.uploadSuccess")),1)])):p("",!0),3===U.value?(f(),c("div",w,[m("span",null,h(d(z)("error.notImage")),1)])):p("",!0)]),m("div",null,[m("div",I,[m("label",x,[m("input",{id:"explore",type:"file",class:"",style:{display:"none"},accept:R.value,onChange:A},null,40,C),m("span",S,h(d(z)("button.upload")),1)])]),m("ul",$,[(f(!0),c(v,null,k(d(J),(e=>(f(),c("li",{key:e.id,class:"mb-3"},[m("div",q,[m("div",F,[m("div",L,[g(a,{"img-item":e},null,8,["img-item"])])]),m("div",N,[m("div",T,h(e.name),1)]),m("div",null,[m("button",{class:"btn btn-error btn-xs",onClick:a=>function(e){"Storage"===e.url&&Y.removeItem(e.id).then((()=>{D.removeImage(e.id)})),D.removeImage(e.id)}(e)},h(d(z)("button.delete")),9,_)])])])))),128))])])],64))}});export{z as default};
