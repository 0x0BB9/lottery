import{_ as t}from"./chunk-C0TPHnv6.js";import{u as a,i as l,a as e}from"./chunk-BrvtIpdZ.js";import{r as o}from"./chunk-Czrwg_dh.js";import{s as n}from"./chunk-DrcNqKZP.js";import{u as s}from"./chunk-CmNriTaI.js";import{r as i,u as r,w as d}from"./chunk-BAe5AcxJ.js";import{z as p,r as c,a as m,I as b,R as u,$ as g,u as h,C as f,F as k,J as y}from"./chunk-D7BOcSyB.js";import"./chunk-Xjp0aulL.js";import"./chunk-DSek3MSI.js";import"./chunk-DvCEEdEu.js";import"./chunk-BWwx0SQ1.js";import"./chunk-BIn6qnQq.js";import"./chunk-BRb02K-I.js";import"./chunk-DwMdLFrw.js";import"./chunk-C6Zwkpkb.js";import"./chunk-BA-TsAJo.js";import"./chunk-BLnK4V6m.js";import"./chunk-DSeHMosA.js";import"./chunk-DC1XHIpb.js";import"./chunk-DE2u7Mu7.js";import"./chunk-Cjrd7Wf_.js";import"./chunk-BT_ACNP_.js";const j={class:"modal-box"},x={class:"text-lg font-bold"},v={class:"py-4"},_={class:"modal-action"},A={method:"dialog",class:"flex gap-3"},N={class:"modal-box"},w={class:"text-lg font-bold"},T={class:"py-4"},C={class:"modal-action"},z={method:"dialog",class:"flex gap-3"},P={class:"min-w-1000px"},D={class:"flex gap-3"},W=["data-tip"],S=["download","href"],J={class:""},M={for:"explore"},O=["data-tip"],L={class:"btn btn-primary btn-sm"},R=p({__name:"PersonAll",setup(p){const{t:R}=s(),$=a().personConfig,{getAllPersonList:I,getAlreadyPersonList:V}=n($),q=c(),E=c();async function F(t){const a=await o(t.target.files[0]),l=i(a,{type:"binary",cellDates:!0}),n=l.Sheets[l.SheetNames[0]],s=r.sheet_to_json(n),d=e(s);$.resetPerson(),$.addNotPersonList(d)}function B(){let t=JSON.parse(JSON.stringify(I.value));for(let e=0;e<t.length;e++)delete t[e].x,delete t[e].y,delete t[e].id,delete t[e].createTime,delete t[e].updateTime,delete t[e].prizeId,t[e].isWin?t[e].isWin=l.global.t("data.yes"):t[e].isWin=l.global.t("data.no"),t[e].prizeTime=t[e].prizeTime.join(","),t[e].prizeName=t[e].prizeName.join(",");let a=JSON.stringify(t);if(a=a.replaceAll(/uid/g,l.global.t("data.number")).replaceAll(/isWin/g,l.global.t("data.isWin")).replaceAll(/department/g,l.global.t("data.department")).replaceAll(/name/g,l.global.t("data.name")).replaceAll(/identity/g,l.global.t("data.identity")).replaceAll(/prizeName/g,l.global.t("data.prizeName")).replaceAll(/prizeTime/g,l.global.t("data.prizeTime")),t=JSON.parse(a),t.length>0){const a=r.json_to_sheet(t),l=r.book_new();r.book_append_sheet(l,a,"Sheet1"),d(l,"data.xlsx")}}function G(){$.resetAlreadyPerson()}function H(){$.deleteAllPerson()}const K=[{label:l.global.t("data.number"),props:"uid"},{label:l.global.t("data.name"),props:"name"},{label:l.global.t("data.department"),props:"department"},{label:l.global.t("data.avatar"),props:"avatar",formatValue:t=>t.avatar?`<img src="${t.avatar}" alt="avatar" style="width: 50px; height: 50px;"/>`:"-"},{label:l.global.t("data.identity"),props:"identity"},{label:l.global.t("data.isWin"),props:"isWin",formatValue:t=>t.isWin?l.global.t("data.yes"):l.global.t("data.no")},{label:l.global.t("data.operation"),actions:[{label:l.global.t("data.delete"),type:"btn-error",onClick:t=>{!function(t){$.deletePerson(t)}(t)}}]}];return m((()=>{})),(a,l)=>(y(),b(k,null,[u("dialog",{id:"my_modal_1",ref_key:"resetDataDialog",ref:q,class:"border-none modal"},[u("div",j,[u("h3",x,g(h(R)("dialog.titleTip")),1),u("p",v,g(h(R)("dialog.dialogResetWinner")),1),u("div",_,[u("form",A,[u("button",{class:"btn",onClick:l[0]||(l[0]=t=>q.value.close())},g(h(R)("button.cancel")),1),u("button",{class:"btn",onClick:G},g(h(R)("button.confirm")),1)])])])],512),u("dialog",{id:"my_modal_1",ref_key:"delAllDataDialog",ref:E,class:"border-none modal"},[u("div",N,[u("h3",w,g(h(R)("dialog.titleTip")),1),u("p",T,g(h(R)("dialog.dialogDelAllPerson")),1),u("div",C,[u("form",z,[u("button",{class:"btn",onClick:l[1]||(l[1]=t=>E.value.close())},g(h(R)("button.cancel")),1),u("button",{class:"btn",onClick:H},g(h(R)("button.confirm")),1)])])])],512),u("div",P,[u("h2",null,g(h(R)("viewTitle.personManagement")),1),u("div",D,[u("button",{class:"btn btn-error btn-sm",onClick:l[2]||(l[2]=t=>E.value.showModal())},g(h(R)("button.allDelete")),1),u("div",{class:"tooltip tooltip-bottom","data-tip":h(R)("tooltip.downloadTemplateTip")},[u("a",{class:"no-underline btn btn-secondary btn-sm",download:h(R)("data.xlsxName"),target:"_blank",href:`/lottery/${h(R)("data.xlsxName")}`},g(h(R)("button.downloadTemplate")),9,S)],8,W),u("div",J,[u("label",M,[u("div",{class:"tooltip tooltip-bottom","data-tip":h(R)("tooltip.uploadExcelTip")},[u("input",{id:"explore",type:"file",class:"",style:{display:"none"},accept:".xlsx,.xls",onChange:F},null,32),u("span",L,g(h(R)("button.importData")),1)],8,O)])]),u("button",{class:"btn btn-error btn-sm",onClick:l[3]||(l[3]=t=>q.value.showModal())},g(h(R)("button.resetData")),1),u("button",{class:"btn btn-accent btn-sm",onClick:B},g(h(R)("button.exportResult")),1),u("div",null,[u("span",null,g(h(R)("table.luckyPeopleNumber"))+":",1),u("span",null,g(h(V).length),1),l[4]||(l[4]=u("span",null," / ",-1)),u("span",null,g(h(I).length),1)])]),f(t,{"table-columns":K,data:h(I)},null,8,["data"])])],64))}});export{R as default};
